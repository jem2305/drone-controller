<!DOCTYPE html>
<html>
  <head>
    <title>WASD Input</title>
    <style>
      body {
        background: linear-gradient(180deg, hsl(255,75%,50%) 0%, hsl(196,90%,50%) 100%);
        background-size: 100vw 100vh;
      }
      img {
        position: fixed;
        height: 250px;
      }
    </style>
    <script>
      var up = false,
      right = false,
      down = false,
      left = false,

      maxDeg = 30,
      minDeg = -30,
      initDeg = 0,
      deg = 0,

      maxX = window.innerWidth/2-130/2 + 150,
      minX = window.innerWidth/2-130/2 - 150,
      initX = window.innerWidth/2-130/2,
      x = window.innerWidth/2-130/2,

      maxY = window.innerHeight/2-130/2 + 150,
      minY = window.innerHeight/2-130/2 - 150,
      initY = window.innerHeight/2-130/2,
      y = window.innerHeight/2-130/2

      document.addEventListener('keydown',press)
      function press(e){
        if (e.keyCode === 38 /* up */ || e.keyCode === 87 /* w */ || e.keyCode === 90 /* z */){
          up = true
        }
        if (e.keyCode === 39 /* right */ || e.keyCode === 68 /* d */){
          right = true
        }
        if (e.keyCode === 40 /* down */ || e.keyCode === 83 /* s */){
          down = true
        }
        if (e.keyCode === 37 /* left */ || e.keyCode === 65 /* a */ || e.keyCode === 81 /* q */){
          left = true
        }
      }
      document.addEventListener('keyup',release)
      function release(e){
        if (e.keyCode === 38 /* up */ || e.keyCode === 87 /* w */ || e.keyCode === 90 /* z */){
          up = false
        }
        if (e.keyCode === 39 /* right */ || e.keyCode === 68 /* d */){
          right = false
        }
        if (e.keyCode === 40 /* down */ || e.keyCode === 83 /* s */){
          down = false
        }
        if (e.keyCode === 37 /* left */ || e.keyCode === 65 /* a */ || e.keyCode === 81 /* q */){
          left = false
        }
      }
      function gameLoop(){
        var div = document.querySelector('img')
        if (up && !(y < minY)){
          y = y - 10
        }
        if (down && !(y > maxY)){
          y = y + 10
        }

        if (right && (up || down) && !(x > maxX)) {
          x = x + 10
        }
        if (left && (up || down) && !(x < minX)) {
          x = x - 10
        }

        if (((!down && right) || (down && left)) && !(deg > maxDeg)){
          deg = deg + 5
        }
        if (((!down && left) || (down && right)) && !(deg < minDeg)){
          deg = deg - 5
        }

        if(!(left || right) && deg != initDeg) {
          if (deg > initDeg) { deg = deg - Math.min(10, deg) }
          else if (deg < initDeg) { deg = deg + Math.min(10, Math.abs(deg)) }

        }

        if(!(left || right || up || down) && x != initX) {
          if (x > initX) { x = x - Math.min(10, x - initX) }
          else { x = x + Math.min(10, initX - x) }
        }


        if(!(up || down) && y != initY) {
          if (y > initY) { y = y - Math.min(10, y - initY) }
          else { y = y + Math.min(10, initY - y) }
        }

        div.style.left = x+'px'
        div.style.top = y+'px'

        if (deg < 0) {
          div.style.transform = 'rotate(+'+ (360 + deg) +'deg)'
        }
        else {
          div.style.transform = 'rotate(+'+ deg +'deg)'
        }
        window.requestAnimationFrame(gameLoop)
      }
      window.requestAnimationFrame(gameLoop)
    </script>
  </head>

  <body>
    <img src="./car.png"></img>
  </body>

</html>